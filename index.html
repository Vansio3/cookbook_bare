<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1e1815">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">

    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link rel="stylesheet" as="style" onload="this.rel='stylesheet'"
        href="https://fonts.googleapis.com/css2?display=swap&family=Noto+Sans%3Awght%40400%3B500%3B700%3B900&family=Plus+Jakarta+Sans%3Awght%40400%3B500%3B700%3B800" />
    <title>Cookbook App</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <style>
        body {
            font-family: "Plus Jakarta Sans", "Noto Sans", sans-serif;
            --checkbox-tick-svg: url('data:image/svg+xml,%3csvg viewBox=%270 0 16 16%27 fill=%27rgb(255,255,255)%27 xmlns=%27http://www.w3.org/2000/svg%27%3e%3cpath d=%27M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z%27/%3e%3c/svg%3e');
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            margin: 0;
            background-color: #1e1815;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            overflow-x: hidden; 
        }

        .page-container { flex-grow: 1; position: relative; display: flex; flex-direction: column; overflow: hidden;}
        .page {
            display: flex; 
            opacity: 0;
            visibility: hidden;
            flex-direction: column;
            width: 100%;
            flex-grow: 1;
            position: absolute; 
            top: 0; left: 0; right: 0; bottom: 0;
            transition: opacity 0.25s ease-in-out, visibility 0.25s ease-in-out;
        }
        .page.active {
            opacity: 1;
            visibility: visible;
            z-index: 10; 
        }
        
        .page-header { position: sticky; top: 0; z-index: 900; }

        #page-index .page-header,
        #page-favorites .page-header,
        #page-profile .page-header { background-color: #1e1815; }
        
        #page-recipe .page-header,
        #page-create-recipe .page-header,
        #page-schedule .page-header,
        #page-shopping-list .page-header { background-color: #231610; }

        .page-content { flex-grow: 1; overflow-y: auto; }
        #page-shopping-list .page-content { padding-bottom: 140px; }
        #page-index .page-content, 
        #page-favorites .page-content,
        #page-recipe .page-content,
        #page-create-recipe .page-content,
        #page-schedule .page-content,
        #page-profile .page-content { padding-bottom: 90px; }

        .bottom-nav-bar { position: sticky; bottom: 0; left: 0; right: 0; z-index: 1000; border-top: 1px solid #40322b; background-color: #2e241f; }

        .interactive-scale { transition: transform 0.1s ease-out; }
        .interactive-scale:active { transform: scale(0.95); }

        .form-checkbox-custom {
            appearance: none; -webkit-appearance: none; -moz-appearance: none;
            height: 1.25rem; width: 1.25rem; border-radius: 0.25rem;
            border-width: 2px; border-color: #684231; background-color: transparent;
            flex-shrink: 0; cursor: pointer;
            transition: background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, transform 0.1s ease-out;
        }
        .form-checkbox-custom:checked {
            background-color: #f0560e; border-color: #f0560e;
            background-image: var(--checkbox-tick-svg); background-repeat: no-repeat;
            background-position: center; background-size: 70%;
        }
        .form-checkbox-custom:active { transform: scale(0.9); }
        .form-checkbox-custom:focus { outline: none; box-shadow: none; border-color: #684231; }

        .shopping-item-checkbox {
            appearance: none; -webkit-appearance: none; -moz-appearance: none;
            height: 1.25rem; width: 1.25rem; border-radius: 0.25rem;
            border-width: 2px; border-color: #684231; background-color: transparent;
            flex-shrink: 0; cursor: pointer;
            transition: background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, transform 0.1s ease-out;
        }
        .shopping-item-checkbox:checked {
            background-color: #52423a; border-color: #52423a;
            background-image: var(--checkbox-tick-svg); background-repeat: no-repeat;
            background-position: center; background-size: 70%;
        }
        .shopping-item-checkbox:active { transform: scale(0.9); }
         .shopping-item-checkbox:focus { outline: none; box-shadow: none; border-color: #684231; }

        .horizontal-scroll-cards { overflow-x: auto; -ms-overflow-style: none; scrollbar-width: none; }
        .horizontal-scroll-cards::-webkit-scrollbar { display: none; }
        
        .schedule-day-btn.selected { background-color: #40322b; border-radius: 0.5rem; }
        .schedule-day-btn.today:not(.selected) .day-number-span { box-shadow: 0 0 0 2px #f0560e; border-radius: 9999px; padding: 0.125rem 0.25rem; }
        .schedule-day-btn.today.selected { border: 2px solid #f0560e; }
        .schedule-day-btn.today .day-name-span, .schedule-day-btn.today .day-number-span { color: #f0560e; }
        .schedule-day-btn.selected:not(.today) .day-name-span { color: #d1d5db; }
        .schedule-day-btn.selected:not(.today) .day-number-span { color: #ffffff; }

        .shopping-item.checked .item-name { text-decoration: line-through; color: #857065; }
        
        @keyframes pulseOpacity { 0%, 100% { opacity: 1; } 50% { opacity: 0.6; } }
        .loading-placeholder { color: #bda89e; text-align: center; padding: 1rem; animation: pulseOpacity 1.5s infinite ease-in-out; }

        #add-meal-modal { transition: opacity 0.2s ease-in-out, visibility 0.2s ease-in-out; }
        #add-meal-modal > div { transition: transform 0.2s ease-out, opacity 0.2s ease-out; transform: scale(0.95); opacity: 0; }
        #add-meal-modal:not(.hidden) > div { transform: scale(1); opacity: 1; }

        .list-item-enter { opacity: 0; transform: translateY(-10px); }
        .list-item-enter-active { opacity: 1; transform: translateY(0); transition: opacity 0.3s ease-out, transform 0.3s ease-out; }
        .list-item-leave { opacity: 1; transform: translateY(0); }
        .list-item-leave-active { opacity: 0; transform: translateY(-10px); transition: opacity 0.2s ease-in, transform 0.2s ease-in; }

        #recipe-bookmark-icon { transition: transform 0.2s cubic-bezier(0.68, -0.55, 0.27, 1.55); }
        #recipe-bookmark-icon.bookmarked-animate { transform: scale(1.3); }
        
        .nav-item.nav-active .nav-icon-container svg { animation: navIconPop 0.3s ease-out; }
        @keyframes navIconPop { 0% { transform: scale(1); } 50% { transform: scale(1.2); } 100% { transform: scale(1); } }

        /* Favorite remove button on card */
        .favorite-remove-btn {
            position: absolute;
            top: 0.5rem; /* 8px */
            right: 0.5rem; /* 8px */
            background-color: rgba(46, 36, 31, 0.7); /* bg-[#2e241f] with opacity */
            border-radius: 9999px; /* rounded-full */
            padding: 0.375rem; /* p-1.5 */
            color: #f0560e; /* text-red-500 equivalent */
            transition: background-color 0.15s ease-in-out, transform 0.1s ease-out;
        }
        .favorite-remove-btn:hover {
            background-color: rgba(64, 50, 43, 0.8); /* hover:bg-[#40322b] with opacity */
        }
         .favorite-remove-btn:active {
            transform: scale(0.9);
        }

    </style>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "%%FIREBASE_API_KEY%%", authDomain: "%%FIREBASE_AUTH_DOMAIN%%",
            projectId: "%%FIREBASE_PROJECT_ID%%", databaseURL: "%%FIREBASE_DATABASE_URL%%",
            storageBucket: "%%FIREBASE_STORAGE_BUCKET%%", messagingSenderId: "%%FIREBASE_MESSAGING_SENDER_ID%%",
            appId: "%%FIREBASE_APP_ID%%", measurementId: "%%FIREBASE_MEASUREMENT_ID%%"
        };
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database(); const serverTimestamp = firebase.database.ServerValue.TIMESTAMP;
        const CLOUDINARY_CLOUD_NAME = "%%CLOUDINARY_CLOUD_NAME%%";
        const CLOUDINARY_UPLOAD_PRESET = "%%CLOUDINARY_UPLOAD_PRESET%%";
        const CLOUDINARY_UPLOAD_URL = `https://api.cloudinary.com/v1_1/${CLOUDINARY_CLOUD_NAME}/image/upload`;
    </script>
</head>

<body>
    <div class="page-container">
        <div id="page-index" class="page bg-[#1e1815] dark group/design-root">
            <div class="page-header">
                <div class="flex items-center p-4 pb-2 justify-between">
                    <h2 class="text-white text-lg font-bold leading-tight tracking-[-0.015em] flex-1 text-center">Opi's Cookbook</h2>
                    <button id="header-profile-button-index" title="Profile" class="interactive-scale text-white flex size-10 items-center justify-center rounded-full hover:bg-white/10"><svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256"><path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24ZM72.28,194.52a64,64,0,0,1,111.44,0,87.65,87.65,0,0,1-111.44,0ZM96,120a32,32,0,1,1,32,32A32,32,0,0,1,96,120Zm97.77,68.38a79.7,79.7,0,0,0-41.49-27.34,48,48,0,1,0-56.56,0,79.7,79.7,0,0,0-41.49,27.34,88,88,0,1,1,139.54,0Z"></path></svg></button>
                </div>
                <div class="px-4 py-3">
                    <label class="flex flex-col min-w-40 h-12 w-full"><div class="flex w-full flex-1 items-stretch rounded-xl h-full"><div class="text-[#bda89e] flex border-none bg-[#40322b] items-center justify-center pl-4 rounded-l-xl border-r-0"><svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256"><path d="M229.66,218.34l-50.07-50.06a88.11,88.11,0,1,0-11.31,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z"></path></svg></div><input placeholder="Search recipes" id="search-recipe-input" class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-white focus:outline-0 focus:ring-0 border-none bg-[#40322b] focus:border-none h-full placeholder:text-[#bda89e] px-4 rounded-l-none border-l-0 pl-2" /></div></label>
                </div>
            </div>
            <div class="page-content">
                <h2 id="recently-added-heading" class="text-white text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5" style="display: none;">Recently Added</h2>
                <div class="horizontal-scroll-cards flex"><div id="featured-recipes-container" class="flex items-stretch p-4 gap-3"><p class="loading-placeholder w-full">Loading recent recipes...</p></div></div>
                <h2 id="all-recipes-heading" class="text-white text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">All Recipes</h2>
                <div id="quick-easy-recipes-container" class="grid grid-cols-[repeat(auto-fit,minmax(158px,1fr))] gap-3 p-4"><p class="loading-placeholder col-span-full">Loading all recipes...</p></div>
            </div>
        </div>

        <div id="page-favorites" class="page bg-[#1e1815] dark group/design-root">
            <div class="page-header">
                <div class="flex items-center p-4 pb-2 justify-between">
                     <div class="interactive-scale text-white flex size-10 shrink-0 items-center cursor-pointer" data-action="back"><svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256"><path d="M224,128a8,8,0,0,1-8,8H59.31l58.35,58.34a8,8,0,0,1-11.32,11.32l-72-72a8,8,0,0,1,0-11.32l72-72a8,8,0,0,1,11.32,11.32L59.31,120H216A8,8,0,0,1,224,128Z"></path></svg></div>
                    <h2 class="text-white text-lg font-bold leading-tight tracking-[-0.015em] flex-1 text-center">Favorite Recipes</h2>
                     <button id="header-profile-button-favorites" title="Profile" class="interactive-scale text-white flex size-10 items-center justify-center rounded-full hover:bg-white/10"><svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256"><path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24ZM72.28,194.52a64,64,0,0,1,111.44,0,87.65,87.65,0,0,1-111.44,0ZM96,120a32,32,0,1,1,32,32A32,32,0,0,1,96,120Zm97.77,68.38a79.7,79.7,0,0,0-41.49-27.34,48,48,0,1,0-56.56,0,79.7,79.7,0,0,0-41.49,27.34,88,88,0,1,1,139.54,0Z"></path></svg></button>
                </div>
                <div class="px-4 py-3">
                    <label class="flex flex-col min-w-40 h-12 w-full"><div class="flex w-full flex-1 items-stretch rounded-xl h-full"><div class="text-[#bda89e] flex border-none bg-[#40322b] items-center justify-center pl-4 rounded-l-xl border-r-0"><svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256"><path d="M229.66,218.34l-50.07-50.06a88.11,88.11,0,1,0-11.31,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z"></path></svg></div><input placeholder="Search favorite recipes" id="search-favorites-input" class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-white focus:outline-0 focus:ring-0 border-none bg-[#40322b] focus:border-none h-full placeholder:text-[#bda89e] px-4 rounded-l-none border-l-0 pl-2" /></div></label>
                </div>
            </div>
            <div class="page-content"><div id="favorites-recipes-container" class="grid grid-cols-[repeat(auto-fit,minmax(158px,1fr))] gap-3 p-4"><p class="loading-placeholder col-span-full">Loading favorites...</p></div></div>
        </div>

        <div id="page-recipe" class="page bg-[#231610] dark group/design-root">
            <div class="page-header">
                <div class="flex items-center p-4 pb-2 justify-between">
                    <div class="interactive-scale text-white flex size-12 shrink-0 items-center cursor-pointer" data-action="back"><svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256"><path d="M224,128a8,8,0,0,1-8,8H59.31l58.35,58.34a8,8,0,0,1-11.32,11.32l-72-72a8,8,0,0,1,0-11.32l72-72a8,8,0,0,1,11.32,11.32L59.31,120H216A8,8,0,0,1,224,128Z"></path></svg></div>
                    <div class="flex items-center justify-end gap-1">
                        <button id="recipe-edit-button" title="Edit Recipe" class="interactive-scale flex h-12 w-12 items-center justify-center rounded-lg text-white hover:bg-white/10"><svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256"><path d="M227.31,73.37,182.63,28.68a16,16,0,0,0-22.63,0L36.69,152A15.86,15.86,0,0,0,32,163.31V208a16,16,0,0,0,16,16H92.69A15.86,15.86,0,0,0,104,219.31L227.31,96a16,16,0,0,0,0-22.63ZM92.69,208H48V163.31l88-88L180.69,120ZM192,108.68,147.31,64l24-24L216,84.68Z"></path></svg></button>
                        <button id="recipe-bookmark-button" class="flex h-12 w-12 items-center justify-center rounded-lg text-white hover:bg-white/10"><div class="text-white"><svg id="recipe-bookmark-icon" xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256"><path d="M184,32H72A16,16,0,0,0,56,48V224a8,8,0,0,0,12.24,6.78L128,193.43l59.77,37.35A8,8,0,0,0,200,224V48A16,16,0,0,0,184,32Zm0,177.57-51.77-32.35a8,8,0,0,0-8.48,0L72,209.57V48H184Z"></path></svg></div></button>
                    </div>
                </div>
            </div>
            <div class="page-content">
                <div class="@container"><div class="@[480px]:px-4 @[480px]:py-3"><div id="recipe-image" class="w-full bg-center bg-no-repeat bg-cover flex flex-col justify-end overflow-hidden @[480px]:rounded-xl min-h-80"></div></div></div>
                <h1 id="recipe-title" class="text-white text-[22px] font-bold px-4 pb-3 pt-5"></h1>
                <p id="recipe-description" class="text-white text-base px-4 pb-3 pt-1"></p>
                <div id="recipe-meta-info" class="flex flex-wrap gap-x-4 gap-y-2 px-4 pb-3 text-[#bda89e] text-sm"></div>
                <div class="flex justify-between items-center px-4 pt-4">
                    <h3 class="text-white text-lg font-bold pb-2">Ingredients</h3>
                    <button id="add-ingredients-to-shopping-list" class="interactive-scale bg-[#f0560e] text-white text-xs font-semibold px-3 py-1.5 rounded-md hover:bg-orange-600">Add to Shopping List</button>
                </div>
                <div id="recipe-ingredients-list" class="px-4"></div>
                <h3 class="text-white text-lg font-bold px-4 pb-2 pt-4">Instructions</h3><div id="recipe-instructions-list" class="px-4"></div>
                <div class="px-4 py-6"><button id="delete-recipe-button" class="interactive-scale w-full bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-xl">Delete Recipe</button></div>
            </div>
        </div>

        <div id="page-create-recipe" class="page bg-[#231610] dark group/design-root">
            <div class="page-header">
                <div class="flex items-center p-4 pb-2 justify-between">
                    <div class="interactive-scale text-white flex size-12 shrink-0 items-center cursor-pointer" data-action="back-from-create"><svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256"><path d="M205.66,194.34a8,8,0,0,1-11.32,11.32L128,139.31,61.66,205.66a8,8,0,0,1-11.32-11.32L116.69,128,50.34,61.66A8,8,0,0,1,61.66,50.34L128,116.69l66.34-66.35a8,8,0,0,1,11.32,11.32L139.31,128Z"></path></svg></div>
                    <h2 class="text-white text-lg font-bold flex-1 text-center pr-12">New Recipe</h2> 
                </div>
            </div>
            <div class="page-content">
                <div class="flex max-w-[480px] flex-col gap-4 px-4 py-3 mx-auto w-full">
                    <label class="flex flex-col w-full"><p class="text-white text-base font-medium pb-2">Recipe Title</p><input id="create-recipe-title" placeholder="Enter recipe title" class="form-input w-full rounded-xl text-white bg-[#342118] border-[#684231] h-14 p-[15px]" /></label>
                    <label class="flex flex-col w-full"><p class="text-white text-base font-medium pb-2">Description</p><textarea id="create-recipe-description" placeholder="Brief description" class="form-input w-full rounded-xl text-white bg-[#342118] border-[#684231] min-h-24 p-[15px]"></textarea></label>
                    <label class="flex flex-col w-full"><p class="text-white text-base font-medium pb-2">Ingredients (one per line)</p><textarea id="create-recipe-ingredients" placeholder="Flour, 1 cup..." class="form-input w-full rounded-xl text-white bg-[#342118] border-[#684231] min-h-36 p-[15px]"></textarea></label>
                    <label class="flex flex-col w-full"><p class="text-white text-base font-medium pb-2">Instructions (one step per line)</p><textarea id="create-recipe-instructions" placeholder="1. Mix flour..." class="form-input w-full rounded-xl text-white bg-[#342118] border-[#684231] min-h-36 p-[15px]"></textarea></label>
                    <div class="flex gap-4 w-full">
                        <label class="flex flex-col flex-1"><p class="text-white text-base font-medium pb-2">Prep Time</p><input id="create-recipe-prepTime" placeholder="e.g., 15 mins" class="form-input w-full rounded-xl text-white bg-[#342118] border-[#684231] h-14 p-[15px]" /></label>
                        <label class="flex flex-col flex-1"><p class="text-white text-base font-medium pb-2">Cook Time</p><input id="create-recipe-cookTime" placeholder="e.g., 30 mins" class="form-input w-full rounded-xl text-white bg-[#342118] border-[#684231] h-14 p-[15px]" /></label>
                    </div>
                    <label class="flex flex-col w-full"><p class="text-white text-base font-medium pb-2">Servings</p><input id="create-recipe-servings" placeholder="e.g., 4" class="form-input w-full rounded-xl text-white bg-[#342118] border-[#684231] h-14 p-[15px]" /></label>
                    <div class="flex flex-col items-center gap-2 p-4 rounded-xl border-2 border-dashed border-[#684231]"><p class="text-white text-lg font-bold">Upload Photo</p><input type="file" id="create-recipe-photoInput" accept="image/*" class="text-white text-sm file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-[#492e22] file:text-white hover:file:bg-[#5a3a2a]"></div>
                </div>
                <div class="flex px-4 py-3 mt-4"><button id="save-recipe-button" class="interactive-scale flex w-full cursor-pointer items-center justify-center rounded-xl h-12 px-5 bg-[#f0560e] text-white text-base font-bold"><span class="truncate">Save Recipe</span></button></div>
            </div>
        </div>

        <div id="page-schedule" class="page bg-[#231610] dark group/design-root">
            <div class="page-header">
                <div class="flex items-center p-4 pb-2 justify-between">
                    <div class="interactive-scale text-white flex size-12 shrink-0 items-center cursor-pointer" data-action="back"><svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256"><path d="M224,128a8,8,0,0,1-8,8H59.31l58.35,58.34a8,8,0,0,1-11.32,11.32l-72-72a8,8,0,0,1,0-11.32l72-72a8,8,0,0,1,11.32,11.32L59.31,120H216A8,8,0,0,1,224,128Z"></path></svg></div>
                    <h2 class="text-white text-lg font-bold flex-1 text-center pr-12">Meal Planner</h2>
                </div>
            </div>
            <div class="page-content">
                <div class="flex items-center justify-between p-4 sticky top-0 bg-[#231610] z-10">
                    <button id="schedule-prev-week" class="interactive-scale text-white p-2 rounded-full hover:bg-white/10"><svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256"><path d="M165.66,202.34a8,8,0,0,1-11.32,11.32l-80-80a8,8,0,0,1,0-11.32l80-80a8,8,0,0,1,11.32,11.32L91.31,128Z"></path></svg></button>
                    <h3 id="schedule-week-range" class="text-white text-lg font-semibold text-center"></h3>
                    <button id="schedule-next-week" class="interactive-scale text-white p-2 rounded-full hover:bg-white/10"><svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256"><path d="M181.66,133.66l-80,80a8,8,0,0,1-11.32-11.32L164.69,128,90.34,53.66a8,8,0,0,1,11.32-11.32l80,80A8,8,0,0,1,181.66,133.66Z"></path></svg></button>
                </div>
                <div id="schedule-week-days" class="flex justify-around p-2 border-b border-gray-700 mb-3 sticky top-[72px] bg-[#231610] z-10"></div>
                <h2 id="schedule-selected-day-title" class="text-white text-[22px] font-bold px-4 pb-3 pt-2">Meals for Today</h2>
                <div id="schedule-meal-list" class="px-4"></div>
                <div class="flex justify-center px-4 py-5"><button id="schedule-open-add-meal-modal-button" class="interactive-scale flex items-center justify-center rounded-xl h-12 px-5 bg-[#f0560e] text-white text-base font-bold gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" fill="currentColor" viewBox="0 0 256 256"><path d="M224,128a8,8,0,0,1-8,8H136v80a8,8,0,0,1-16,0V136H40a8,8,0,0,1,0-16h80V40a8,8,0,0,1,16,0v80h80A8,8,0,0,1,224,128Z"></path></svg><span>Add Meal</span></button></div>
            </div>
            <div id="add-meal-modal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[1100] hidden">
                <div class="bg-[#2e241f] p-4 rounded-lg shadow-xl w-11/12 max-w-md max-h-[80vh] flex flex-col">
                    <div class="flex justify-between items-center mb-3">
                        <h3 class="text-white text-xl font-bold">Add Recipe to Meal Plan</h3>
                        <button id="add-meal-modal-close-button" class="interactive-scale text-white p-1 hover:bg-white/10 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 256 256"><path d="M205.66,194.34a8,8,0,0,1-11.32,11.32L128,139.31,61.66,205.66a8,8,0,0,1-11.32-11.32L116.69,128,50.34,61.66A8,8,0,0,1,61.66,50.34L128,116.69l66.34-66.35a8,8,0,0,1,11.32,11.32L139.31,128Z"></path></svg></button>
                    </div>
                    <div class="mb-3"><input type="text" id="add-meal-modal-search" placeholder="Search recipes..." class="form-input w-full rounded-lg text-white bg-[#40322b] border-[#684231] h-12 p-3 placeholder:text-[#bda89e] focus:ring-1 focus:ring-[#f0560e] focus:border-[#f0560e]"></div>
                    <div id="add-meal-modal-recipe-list" class="overflow-y-auto flex-grow space-y-2 pr-1"></div>
                </div>
            </div>
        </div>

        <div id="page-shopping-list" class="page bg-[#231610] dark group/design-root">
            <div class="page-header">
                <div class="flex items-center p-4 pb-2 justify-between">
                    <div class="interactive-scale text-white flex size-12 shrink-0 items-center cursor-pointer" data-action="back"><svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256"><path d="M224,128a8,8,0,0,1-8,8H59.31l58.35,58.34a8,8,0,0,1-11.32,11.32l-72-72a8,8,0,0,1,0-11.32l72-72a8,8,0,0,1,11.32,11.32L59.31,120H216A8,8,0,0,1,224,128Z"></path></svg></div>
                    <h2 class="text-white text-lg font-bold flex-1 text-center">Shopping List</h2>
                    <button id="clear-checked-shopping-items-button" title="Clear Checked Items" class="interactive-scale text-white flex size-12 items-center justify-center rounded-full hover:bg-white/10">
                         <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256"><path d="M216,48H176V40a24,24,0,0,0-24-24H104A24,24,0,0,0,80,40v8H40a8,8,0,0,0,0,16h8V208a16,16,0,0,0,16,16H192a16,16,0,0,0,16-16V64h8a8,8,0,0,0,0-16ZM96,40a8,8,0,0,1,8-8h48a8,8,0,0,1,8,8v8H96Zm96,168H64V64H192ZM112,104v64a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Zm48,0v64a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Z"></path></svg>
                    </button>
                </div>
            </div>
            <div class="page-content px-4 pt-4">
                <div id="shopping-list-items-container" class="space-y-2"></div>
            </div>
            <div class="sticky bottom-[4px] left-0 right-0 bg-[#2e241f] p-3 border-t border-[#40322b] z-50 flex gap-2 items-center">
                 <input type="text" id="new-shopping-item-name" placeholder="Add item..." class="form-input flex-grow rounded-lg text-white bg-[#40322b] border-[#684231] h-11 p-3 placeholder:text-[#bda89e] focus:ring-1 focus:ring-[#f0560e] focus:border-[#f0560e]">
                 <button id="add-shopping-item-button" class="interactive-scale bg-[#f0560e] text-white rounded-lg p-2.5 h-11 w-11 flex items-center justify-center shrink-0 hover:bg-orange-600">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" fill="currentColor" viewBox="0 0 256 256"><path d="M224,128a8,8,0,0,1-8,8H136v80a8,8,0,0,1-16,0V136H40a8,8,0,0,1,0-16h80V40a8,8,0,0,1,16,0v80h80A8,8,0,0,1,224,128Z"></path></svg>
                 </button>
            </div>
        </div>

        <div id="page-profile" class="page bg-[#1e1815] dark group/design-root">
            <div class="page-header">
                <div class="flex items-center p-4 pb-2 justify-between">
                    <div class="interactive-scale text-white flex size-12 shrink-0 items-center cursor-pointer" data-action="back"><svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256"><path d="M224,128a8,8,0,0,1-8,8H59.31l58.35,58.34a8,8,0,0,1-11.32,11.32l-72-72a8,8,0,0,1,0-11.32l72-72a8,8,0,0,1,11.32,11.32L59.31,120H216A8,8,0,0,1,224,128Z"></path></svg></div>
                    <h2 class="text-white text-lg font-bold flex-1 text-center pr-12">Profile</h2>
                </div>
            </div>
            <div class="page-content flex flex-col items-center justify-center">
                <h1 class="text-white text-3xl">Profile Page</h1>
                <p class="text-[#bda89e] mt-4">This is a placeholder.</p>
            </div>
        </div>
    </div>

    <div class="bottom-nav-bar">
        <div class="flex gap-1 px-2 pb-3 pt-2">
            <a class="nav-item interactive-scale just flex flex-1 flex-col items-center justify-end gap-1 rounded-full text-white" href="#" data-target="page-index" data-icon-name="BookOpen"><div class="nav-icon-container text-white flex h-8 items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256"><path d="M224,48H160a40,40,0,0,0-32,16A40,40,0,0,0,96,48H32A16,16,0,0,0,16,64V192a16,16,0,0,0,16,16H96a24,24,0,0,1,24,24,8,8,0,0,0,16,0,24,24,0,0,1,24-24h64a16,16,0,0,0,16-16V64A16,16,0,0,0,224,48ZM96,192H32V64H96a24,24,0,0,1,24,24V200A39.81,39.81,0,0,0,96,192Zm128,0H160a39.81,39.81,0,0,0-24,8V88a24,24,0,0,1,24-24h64Z"></path></svg></div><p class="nav-text text-white text-xs font-medium">Recipes</p></a>
            <a class="nav-item interactive-scale just flex flex-1 flex-col items-center justify-end gap-1 text-[#bda89e]" href="#" data-target="page-favorites" data-icon-name="Heart"><div class="nav-icon-container text-[#bda89e] flex h-8 items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256"><path d="M240,94c0,70-103.79,126.66-108.21,129a8,8,0,0,1-7.58,0C119.79,220.66,16,164,16,94A62.07,62.07,0,0,1,78,32c20.65,0,38.41,8.88,50,23.89C139.59,40.88,157.35,32,178,32A62.07,62.07,0,0,1,240,94Zm-16,0a46.06,46.06,0,0,0-46-46c-19.45,0-35.78,10.36-42.6,27a8,8,0,0,1-14.8,0C114.78,58.36,98.45,48,79,48a46.06,46.06,0,0,0-46,46c0,51.91,74.22,96.66,91.08,107.18a8,8,0,0,0,7.84,0C148.78,190.66,224,145.91,224,94Z"></path></svg></div><p class="nav-text text-[#bda89e] text-xs font-medium">Favorites</p></a>
            <a class="nav-item interactive-scale just flex flex-1 flex-col items-center justify-end gap-1 text-[#bda89e]" href="#" data-target="page-create-recipe" data-icon-name="PlusSquare"><div class="nav-icon-container text-[#bda89e] flex h-8 items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256"><path d="M208,32H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32Zm0,176H48V48H208V208Zm-32-80a8,8,0,0,1-8,8H136v32a8,8,0,0,1-16,0V136H88a8,8,0,0,1,0-16h32V88a8,8,0,0,1,16,0v32h32A8,8,0,0,1,176,128Z"></path></svg></div><p class="nav-text text-[#bda89e] text-xs font-medium">Create</p></a>
            <a class="nav-item interactive-scale just flex flex-1 flex-col items-center justify-end gap-1 text-[#bda89e]" href="#" data-target="page-shopping-list" data-icon-name="ShoppingCart"><div class="nav-icon-container text-[#bda89e] flex h-8 items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256"><path d="M96,216a16,16,0,1,1-16-16A16,16,0,0,1,96,216Zm88-16a16,16,0,1,0,16,16A16,16,0,0,0,184,200ZM228.1,65.21l-28.52,92.68A23.88,23.88,0,0,1,176.7,176H88.06A24,24,0,0,1,65.9,159.34L29.11,50.3A8,8,0,0,0,24,48H16a8,8,0,0,1,0-16H24a16,16,0,0,1,15.23,10.31L50.1,63.36A8,8,0,0,1,56,64H216a8,8,0,0,1,7.44,10.33A8.12,8.12,0,0,1,228.1,65.21ZM82.25,160H176.7a8,8,0,0,0,7.58-5.07L208,72H60.49Z"></path></svg></div><p class="nav-text text-[#bda89e] text-xs font-medium">Shopping</p></a>
            <a class="nav-item interactive-scale just flex flex-1 flex-col items-center justify-end gap-1 text-[#bda89e]" href="#" data-target="page-schedule" data-icon-name="Calendar"><div class="nav-icon-container text-[#bda89e] flex h-8 items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256"><path d="M208,32H184V24a8,8,0,0,0-16,0v8H88V24a8,8,0,0,0-16,0v8H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32ZM72,48v8a8,8,0,0,0,16,0V48h80v8a8,8,0,0,0,16,0V48h24V80H48V48ZM208,208H48V96H208V208Zm-96-88v64a8,8,0,0,1-16,0V132.94l-4.42,2.22a8,8,0,0,1-7.16-14.32l16-8A8,8,0,0,1,112,120Zm59.16,30.45L152,176h16a8,8,0,0,1,0,16H136a8,8,0,0,1-6.4-12.8l28.78-38.37A8,8,0,1,0,145.07,132a8,8,0,1,1-13.85-8A24,24,0,0,1,176,136,23.76,23.76,0,0,1,171.16,150.45Z"></path></svg></div><p class="nav-text text-[#bda89e] text-xs font-medium">Meal Plan</p></a>
        </div>
    </div>

    <script>
        let currentPageId="page-index",previousPageId="page-index",allRecipesCache=[],editingRecipeId=null,currentRecipeImageURL=null,currentSelectedDate=new Date,currentDisplayedWeekStartDate=getStartOfWeek(new Date),isInitialPageLoad=!0;function getStartOfWeek(e,t=0){const c=new Date(e),a=c.getDay(),n=(a<t?a+7:a)-t;return c.setDate(c.getDate()-n),c.setHours(0,0,0,0),c}function addDays(e,t){const c=new Date(e);return c.setDate(c.getDate()+t),c}function formatDateForDisplay(e){return isToday(e)?"Today":isSameDate(e,addDays(new Date,1))?"Tomorrow":e.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})}function formatDateForFirebaseKey(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}function isSameDate(e,t){return!(!e||!t)&&e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function isToday(e){return isSameDate(e,new Date)}function debounce(e,t){let c;return function(...a){clearTimeout(c),c=setTimeout(()=>e.apply(this,a),t)}}
        function showPage(e,t=!1){const c=document.getElementById(currentPageId);c&&c.classList.remove("active");const a=document.getElementById(e);a?(t||currentPageId===e||(previousPageId=currentPageId,"page-index"!==e?history.pushState({page:e},`Page ${e}`,`#${e}`):""===location.hash||"#page-index"===location.hash||history.pushState({page:"page-index"},"Page page-index","#page-index")),currentPageId=e,localStorage.setItem("lastActivePageId",e),requestAnimationFrame(()=>{a.classList.add("active")}),updateNavbarUI(e),a.querySelector(".page-content")?.scrollTo(0,0),"page-index"===e?(document.getElementById("search-recipe-input")?.value.trim()||handleSearch()):"page-favorites"===e?renderFavoritesPage():"page-schedule"===e?((t&&"page-recipe"===previousPageId)||(currentSelectedDate=new Date,currentDisplayedWeekStartDate=getStartOfWeek(new Date)),renderWeekView()):"page-shopping-list"===e&&loadShoppingListFromDB(),isInitialPageLoad=!1):showPage("page-index")}
        function updateNavbarUI(e){document.querySelectorAll(".nav-item").forEach(t=>{t.classList.remove("nav-active");const c=t.dataset.target;let a="page-recipe"===e?c===previousPageId&&("page-index"===previousPageId||"page-favorites"===previousPageId)?!0:"page-index"===c&&"page-favorites"!==previousPageId?!0:!1:c===e;const n=a?"text-white":"text-[#bda89e]",o=t.querySelector(".nav-icon-container"),i=t.querySelector(".nav-text");["text-white","text-[#bda89e]"].forEach(e=>{t.classList.remove(e),i?.classList.remove(e),o?.classList.remove(e)}),t.classList.add(n),i?.classList.add(n),o?.classList.add(n),a&&t.classList.add("nav-active"),"page-favorites"===c&&o&&o.querySelector("svg")&&(o.querySelector("svg").innerHTML=a?'<path d="M178,32c-20.65,0-38.41,8.88-50,23.89C116.41,40.88,98.65,32,78,32A62.07,62.07,0,0,0,16,94c0,70,103.79,126.66,108.21,129a8,8,0,0,0,7.58,0C136.21,220.66,240,164,240,94A62.07,62.07,0,0,0,178,32Z"></path>':'<path d="M240,94c0,70-103.79,126.66-108.21,129a8,8,0,0,1-7.58,0C119.79,220.66,16,164,16,94A62.07,62.07,0,0,1,78,32c20.65,0,38.41,8.88,50,23.89C139.59,40.88,157.35,32,178,32A62.07,62.07,0,0,1,240,94Zm-16,0a46.06,46.06,0,0,0-46-46c-19.45,0-35.78,10.36-42.6,27a8,8,0,0,1-14.8,0C114.78,58.36,98.45,48,79,48a46.06,46.06,0,0,0-46,46c0,51.91,74.22,96.66,91.08,107.18a8,8,0,0,0,7.84,0C148.78,190.66,224,145.91,224,94Z"></path>')})}
        async function loadRecipesFromRealtimeDB(){const e=document.getElementById("featured-recipes-container"),t=document.getElementById("quick-easy-recipes-container");e&&(e.innerHTML='<p class="loading-placeholder w-full">Loading recent recipes...</p>'),t&&(t.innerHTML='<p class="loading-placeholder col-span-full">Loading all recipes...</p>');try{const c=await database.ref("recipes").orderByChild("createdAt").once("value");allRecipesCache=[],c.exists()&&(allRecipesCache=Object.keys(c.val()).map(e=>({id:e,...c.val()[e]})).sort((e,t)=>(t.createdAt||0)-(e.createdAt||0)));const a=localStorage.getItem("lastActivePageId")||"page-index";"page-index"===a?document.getElementById("search-recipe-input")?.value.trim()?handleSearch():populateRecipeListsUI(allRecipesCache):"page-favorites"===a&&renderFavoritesPage()}catch(e){console.error("Error recipes:",e),alert("Could not load recipes."),e&&(e.innerHTML=""),t&&(t.innerHTML="")}}
        function populateRecipeListsUI(e,t=!1){const c=document.getElementById("featured-recipes-container"),a=document.getElementById("quick-easy-recipes-container"),n=document.getElementById("recently-added-heading"),o=document.getElementById("all-recipes-heading");if(c.innerHTML="",a.innerHTML="",t)n.style.display="none",o.style.display="none",c.style.display="none",0===e.length?a.innerHTML='<p class="text-center text-[#cba390] py-4 col-span-full w-full">No recipes matching search.</p>':e.forEach(e=>a.innerHTML+=createRecipeCardHtml(e));else{const i=e.slice(0,3);i.length>0?(n.style.display="block",c.style.display="flex",i.forEach(e=>c.innerHTML+=createRecipeCardHtml(e,!0))):(n.style.display="none",c.style.display="none");const r='<p class="text-center text-[#cba390] py-4 px-4 w-full col-span-full">No recipes yet. Create one!</p>';if(0===e.length)o.style.display="none",a.innerHTML=r;else{o.style.display="block";const s=[...e].sort((e,c)=>(e.title||"").localeCompare(c.title||""));s.forEach(e=>a.innerHTML+=createRecipeCardHtml(e))}}attachRecipeCardListeners()}
        function createRecipeCardHtml(e,t=!1,c=!1){const a=(e.description||"No description.").substring(0,70)+((e.description||"").length>70?"...":""),n=`style='background-image: url("${e.imageURL||"https://via.placeholder.com/300x200.png?text=No+Image"}");'`,o=t?`<div class="flex h-full flex-1 flex-col gap-4 rounded-lg min-w-60 cursor-pointer" data-recipe-id="${e.id}"><div class="w-full bg-center bg-no-repeat aspect-video bg-cover rounded-xl" ${n}></div><div><p class="text-white text-base font-medium">${e.title||"Untitled"}</p><p class="text-[#bda89e] text-sm">${a}</p></div></div>`:`<div class="relative flex flex-col gap-3 pb-3 cursor-pointer" data-recipe-id="${e.id}"><div class="w-full bg-center bg-no-repeat aspect-square bg-cover rounded-xl" ${n}></div><div><p class="text-white text-base font-medium">${e.title||"Untitled"}</p><p class="text-[#bda89e] text-sm">${a}</p></div>${c?`<button class="favorite-remove-btn interactive-scale" data-remove-favorite-id="${e.id}" title="Remove from favorites"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 256 256"><path fill="currentColor" d="M178,32c-20.65,0-38.41,8.88-50,23.89C116.41,40.88,98.65,32,78,32A62.07,62.07,0,0,0,16,94c0,70,103.79,126.66,108.21,129a8,8,0,0,0,7.58,0C136.21,220.66,240,164,240,94A62.07,62.07,0,0,0,178,32Z"></path></svg></button>`:""}</div>`;return o}
        function handleSearch(){const e=document.getElementById("search-recipe-input");if(!e)return;const t=e.value.trim().toLowerCase();""===t?populateRecipeListsUI(allRecipesCache):populateRecipeListsUI(allRecipesCache.filter(e=>(e.title||"").toLowerCase().includes(t)||(e.description||"").toLowerCase().includes(t)),!0)}
        function renderFavoritesPage(){const e=document.getElementById("favorites-recipes-container");e&&(e.innerHTML='<p class="loading-placeholder col-span-full">Loading favorites...</p>');const t=document.getElementById("search-favorites-input"),c=t?t.value.trim().toLowerCase():"";let a=allRecipesCache.filter(e=>e.isBookmarked);""!==c&&(a=a.filter(e=>(e.title||"").toLowerCase().includes(c)||(e.description||"").toLowerCase().includes(c))),populateFavoritesListUI(a,""!==c)}
        function populateFavoritesListUI(e,t=!1){const c=document.getElementById("favorites-recipes-container");if(c.innerHTML="",0===e.length){const a=t?'<p class="text-center text-[#cba390] py-4 col-span-full w-full">No favorite recipes matching search.</p>':'<p class="text-center text-[#cba390] py-4 col-span-full w-full">No favorite recipes yet. Bookmark some!</p>';c.innerHTML=a}else e.forEach(e=>c.innerHTML+=createRecipeCardHtml(e,!1,!0));attachRecipeCardListeners(),document.querySelectorAll(".favorite-remove-btn").forEach(e=>e.addEventListener("click",t=>{t.stopPropagation();const c=e.dataset.removeFavoriteId;c&&toggleBookmarkInRealtimeDB(c)}))}
        function handleFavoritesSearch(){renderFavoritesPage()}function attachRecipeCardListeners(){document.querySelectorAll("[data-recipe-id]").forEach(e=>{e.removeEventListener("click",handleRecipeCardClick),e.addEventListener("click",handleRecipeCardClick)})}
        function handleRecipeCardClick(e){if(e.target.closest(".favorite-remove-btn"))return;const t=e.currentTarget.dataset.recipeId;t&&loadRecipeDetailFromRealtimeDB(t)}
        async function loadRecipeDetailFromRealtimeDB(e){const t=allRecipesCache.find(t=>t.id===e);if(t&&t.ingredients&&t.instructions&&t.description)return displayRecipeDetailsUI(t),void showPage("page-recipe");if(0===allRecipesCache.length&&!isInitialPageLoad){await loadRecipesFromRealtimeDB();const c=allRecipesCache.find(t=>t.id===e);if(c)return displayRecipeDetailsUI(c),void showPage("page-recipe")}try{const c=await database.ref(`recipes/${e}`).once("value");c.exists()?(displayRecipeDetailsUI({id:e,...c.val()}),showPage("page-recipe")):(alert("Recipe not found."),showPage(previousPageId||"page-index",!0))}catch(e){console.error("Error getting recipe:",e),alert("Recipe load failed.")}}
        function displayRecipeDetailsUI(e){document.getElementById("page-recipe").dataset.currentRecipeId=e.id,document.getElementById("recipe-image").style.backgroundImage=`url("${e.imageURL||"https://via.placeholder.com/300x200.png?text=No+Image"}")`,document.getElementById("recipe-title").textContent=e.title||"Untitled",document.getElementById("recipe-description").textContent=e.description||"No description.";const t=document.getElementById("recipe-meta-info");if(t.innerHTML="",(e.prepTime||e.cookTime||e.servings)){let c="";e.prepTime&&(c+=`<div class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="mr-1.5 shrink-0" viewBox="0 0 256 256"><path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm64-88a8,8,0,0,1-8,8H128a8,8,0,0,1-8-8V72a8,8,0,0,1,16,0v48h48A8,8,0,0,1,192,128Z"></path></svg> Prep: ${e.prepTime}</div>`),e.cookTime&&(c+=`<div class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="mr-1.5 shrink-0" viewBox="0 0 256 256"><path d="M208,88H164.86l15.25-41.19a12,12,0,0,0-22.22-8.22L140,82.38V40a12,12,0,0,0-24,0V88H72A36,36,0,0,0,72,160h8v48a20,20,0,0,0,40,0V160h16v48a20,20,0,0,0,40,0V160h8a36,36,0,0,0,24-72Zm-8,56H72a20,20,0,0,1,0-40H200a20,20,0,0,1,0,40Z"></path></svg> Cook: ${e.cookTime}</div>`),e.servings&&(c+=`<div class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="mr-1.5 shrink-0" viewBox="0 0 256 256"><path d="M230.92,212c-15.23-26.33-38.7-45.21-66.09-54.16a72,72,0,1,0-73.66,0C63.78,166.78,40.31,185.66,25.08,212a8,8,0,1,0,13.85,8c18.84-32.56,52.14-52,89.07-52s70.23,19.44,89.07,52a8,8,0,1,0,13.85-8ZM72,96a56,56,0,1,1,56,56A56.06,56.06,0,0,1,72,96Z"></path></svg> Serves: ${e.servings}</div>`),t.innerHTML=c}const a=document.getElementById("recipe-ingredients-list");a.innerHTML="",(e.ingredients||[]).forEach(e=>a.innerHTML+=`<label class="flex gap-x-3 py-3 items-center"><input type="checkbox" class="form-checkbox-custom"/><p class="text-white text-base">${e}</p></label>`);const n=document.getElementById("recipe-instructions-list");n.innerHTML="",(e.instructions||[]).forEach(e=>n.innerHTML+=`<div class="flex items-center min-h-14 py-1"><p class="text-white text-base flex-1">${e}</p></div>`);const o=document.getElementById("recipe-bookmark-icon");o.innerHTML=e.isBookmarked?'<path d="M240,94c0,70-103.79,126.66-108.21,129a8,8,0,0,1-7.58,0C119.79,220.66,16,164,16,94A62.07,62.07,0,0,1,78,32c20.65,0,38.41,8.88,50,23.89C139.59,40.88,157.35,32,178,32A62.07,62.07,0,0,1,240,94Zm-16,0a46.06,46.06,0,0,0-46-46c-19.45,0-35.78,10.36-42.6,27a8,8,0,0,1-14.8,0C114.78,58.36,98.45,48,79,48a46.06,46.06,0,0,0-46,46c0,51.91,74.22,96.66,91.08,107.18a8,8,0,0,0,7.84,0C148.78,190.66,224,145.91,224,94Z"></path>':'<path d="M184,32H72A16,16,0,0,0,56,48V224a8,8,0,0,0,12.24,6.78L128,193.43l59.77,37.35A8,8,0,0,0,200,224V48A16,16,0,0,0,184,32Zm0,177.57-51.77-32.35a8,8,0,0,0-8.48,0L72,209.57V48H184Z"></path>',o.classList.toggle("text-[#f0560e]",!!e.isBookmarked),o.classList.toggle("text-white",!e.isBookmarked),document.getElementById("recipe-bookmark-button").dataset.recipeId=e.id,document.getElementById("delete-recipe-button").dataset.recipeId=e.id,document.getElementById("delete-recipe-button").dataset.imageURL=e.imageURL||""}
        function resetCreateForm(){document.getElementById("create-recipe-title").value="",document.getElementById("create-recipe-description").value="",document.getElementById("create-recipe-ingredients").value="",document.getElementById("create-recipe-instructions").value="",document.getElementById("create-recipe-prepTime").value="",document.getElementById("create-recipe-cookTime").value="",document.getElementById("create-recipe-servings").value="",document.getElementById("create-recipe-photoInput").value="",document.querySelector("#page-create-recipe .page-header h2").textContent="New Recipe",editingRecipeId=null,currentRecipeImageURL=null}
        async function prepareEditForm(e){const t=database.ref(`recipes/${e}`);try{const c=await t.once("value");if(c.exists()){const a=c.val();editingRecipeId=e,currentRecipeImageURL=a.imageURL||"",document.querySelector("#page-create-recipe .page-header h2").textContent="Edit Recipe",document.getElementById("create-recipe-title").value=a.title||"",document.getElementById("create-recipe-description").value=a.description||"",document.getElementById("create-recipe-ingredients").value=(a.ingredients||[]).join("\n"),document.getElementById("create-recipe-instructions").value=(a.instructions||[]).join("\n"),document.getElementById("create-recipe-prepTime").value=a.prepTime||"",document.getElementById("create-recipe-cookTime").value=a.cookTime||"",document.getElementById("create-recipe-servings").value=a.servings||"",document.getElementById("create-recipe-photoInput").value="",showPage("page-create-recipe")}else alert("Recipe not found for editing."),resetCreateForm()}catch(e){console.error("Error fetching for edit:",e),alert("Could not load for editing."),resetCreateForm()}}
        async function saveRecipeData(){const e=document.getElementById("create-recipe-title").value.trim();if(!e)return void alert("Recipe title is required.");const t=document.getElementById("create-recipe-description").value.trim(),c=document.getElementById("create-recipe-ingredients").value.split("\n").map(e=>e.trim()).filter(e=>e),a=document.getElementById("create-recipe-instructions").value.split("\n").map(e=>e.trim()).filter(e=>e),n=document.getElementById("create-recipe-prepTime").value.trim(),o=document.getElementById("create-recipe-cookTime").value.trim(),i=document.getElementById("create-recipe-servings").value.trim(),r=document.getElementById("create-recipe-photoInput"),s=document.getElementById("save-recipe-button");s.textContent="Saving...",s.disabled=!0;let l=editingRecipeId?currentRecipeImageURL:"";try{if(r.files[0]){const e=r.files[0],t=new FormData;t.append("file",e),t.append("upload_preset",CLOUDINARY_UPLOAD_PRESET);const c=await fetch(CLOUDINARY_UPLOAD_URL,{method:"POST",body:t}),a=await c.json();if(a.secure_url)l=a.secure_url;else throw new Error(a.error?.message||"Cloudinary upload failed")}const d={title:e,description:t,ingredients:c,instructions:a,prepTime:n,cookTime:o,servings:i,imageURL:l,isBookmarked:editingRecipeId?allRecipesCache.find(e=>e.id===editingRecipeId)?.isBookmarked||!1:!1};if(editingRecipeId){const e=await database.ref(`recipes/${editingRecipeId}/createdAt`).once("value");d.createdAt=e.exists()?e.val():serverTimestamp,d.updatedAt=serverTimestamp,await database.ref(`recipes/${editingRecipeId}`).update(d),alert("Recipe updated!")}else d.createdAt=serverTimestamp,await database.ref("recipes").push().set(d),alert("Recipe saved!");resetCreateForm(),await loadRecipesFromRealtimeDB(),showPage("page-index")}catch(e){console.error("Error saving recipe:",e),alert(`Failed to save: ${e.message}`)}finally{s.textContent="Save Recipe",s.disabled=!1}}
        async function deleteRecipeFromRealtimeDB(e,t){if(!confirm("Delete this recipe?"))return;try{await database.ref(`recipes/${e}`).remove(),alert("Recipe deleted."),await loadRecipesFromRealtimeDB(),showPage(previousPageId||"page-index",!0)}catch(e){console.error("Error deleting recipe:",e),alert("Failed to delete.")}}
        async function toggleBookmarkInRealtimeDB(e){const t=database.ref(`recipes/${e}`);try{const c=await t.once("value");if(c.exists()){const a=!c.val().isBookmarked;await t.update({isBookmarked:a});const n=document.getElementById("recipe-bookmark-icon");n&&(n.innerHTML=a?'<path d="M184,32H72A16,16,0,0,0,56,48V224a8,8,0,0,0,12.24,6.78L128,193.43l59.77,37.35A8,8,0,0,0,200,224V48A16,16,0,0,0,184,32Z"></path>':'<path d="M184,32H72A16,16,0,0,0,56,48V224a8,8,0,0,0,12.24,6.78L128,193.43l59.77,37.35A8,8,0,0,0,200,224V48A16,16,0,0,0,184,32Zm0,177.57-51.77-32.35a8,8,0,0,0-8.48,0L72,209.57V48H184Z"></path>',n.classList.toggle("text-[#f0560e]",a),n.classList.toggle("text-white",!a),n.classList.add("bookmarked-animate"),setTimeout(()=>n.classList.remove("bookmarked-animate"),200));const o=allRecipesCache.find(t=>t.id===e);o&&(o.isBookmarked=a),"page-favorites"===currentPageId&&renderFavoritesPage()}}catch(e){console.error("Error toggling bookmark:",e)}}
        function renderWeekView(){const e=document.getElementById("schedule-week-days"),t=document.getElementById("schedule-week-range");if(!e||!t)return;e.innerHTML="";const c=new Intl.DateTimeFormat("en-US",{weekday:"short"}),a=new Intl.DateTimeFormat("en-US",{day:"numeric"});let n=new Date(currentDisplayedWeekStartDate);for(let o=0;o<7;o++){const i=document.createElement("button");i.className="schedule-day-btn flex flex-col items-center p-1.5 fo w-[calc(100%/7-4px)] mx-0.5",i.dataset.date=n.toISOString();const r=isToday(n),s=isSameDate(n,currentSelectedDate);i.innerHTML=`<span class="day-name-span text-xs ${r&&!s?"text-[#f0560e]":"text-gray-400"}">${c.format(n).toUpperCase()}</span><span class="day-number-span text-lg font-bold ${r&&!s?"text-[#f0560e]":"text-white"}">${a.format(n)}</span>`,s&&i.classList.add("selected"),r&&i.classList.add("today"),i.addEventListener("click",handleWeekDayClick),e.appendChild(i),n=addDays(n,1)}t.textContent=`${currentDisplayedWeekStartDate.toLocaleDateString("en-US",{month:"short",day:"numeric"})} - ${addDays(currentDisplayedWeekStartDate,6).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`,loadMealsForSelectedDate()}
        function handleWeekDayClick(e){currentSelectedDate=new Date(e.currentTarget.dataset.date),renderWeekView()}function navigateToPreviousWeek(){currentDisplayedWeekStartDate=addDays(currentDisplayedWeekStartDate,-7),currentSelectedDate=new Date(currentDisplayedWeekStartDate),renderWeekView()}function navigateToNextWeek(){currentDisplayedWeekStartDate=addDays(currentDisplayedWeekStartDate,7),currentSelectedDate=new Date(currentDisplayedWeekStartDate),renderWeekView()}
        function loadMealsForSelectedDate(){const e=document.getElementById("schedule-selected-day-title");e&&(e.textContent=`Meals for ${formatDateForDisplay(currentSelectedDate)}`,loadMealPlanForDateFromRealtimeDB(formatDateForFirebaseKey(currentSelectedDate)))}
        async function loadMealPlanForDateFromRealtimeDB(e){const t=document.getElementById("schedule-meal-list");if(!t)return;t.innerHTML='<p class="loading-placeholder">Loading meals...</p>';try{const c=await database.ref(`mealPlan/${e}`).once("value");displayPlannedMealsUI(c.exists()?c.val():{},e)}catch(e){console.error("Error fetching meal plan:",e),t.innerHTML='<p class="loading-placeholder text-red-500">Error loading meals.</p>'}}
        function displayPlannedMealsUI(e,t){const c=document.getElementById("schedule-meal-list");if(!c)return;c.innerHTML="",0===Object.keys(e).length?(c.innerHTML='<p class="loading-placeholder">No meals planned.</p>',void 0):Object.entries(e).forEach(([a,n])=>{const o=allRecipesCache.find(e=>e.id===n.recipeId),i=o?.imageURL||"https://via.placeholder.com/100x100.png?text=No+Img",r=o?.cookTime||"N/A",s=document.createElement("div");s.className="flex items-center justify-between gap-4 p-2 mb-2 bg-[#40322b] rounded-lg",s.dataset.recipeId=n.recipeId,s.dataset.mealPlanEntryId=a,s.innerHTML=`<div class="flex items-center gap-3 flex-grow cursor-pointer" data-action="view-recipe-from-plan"><div class="bg-center bg-no-repeat aspect-square bg-cover rounded-md size-14 shrink-0" style='background-image: url("${i}");'></div><div><p class="text-white text-base font-medium">${n.recipeTitle||"Unknown"}</p><p class="text-[#cba390] text-sm">Cook: ${r}</p></div></div><button class="interactive-scale remove-meal-button text-red-400 hover:text-red-600 p-2 rounded-full hover:bg-white/10" title="Remove"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256"><path d="M216,48H176V40a24,24,0,0,0-24-24H104A24,24,0,0,0,80,40v8H40a8,8,0,0,0,0,16h8V208a16,16,0,0,0,16,16H192a16,16,0,0,0,16-16V64h8a8,8,0,0,0,0-16ZM96,40a8,8,0,0,1,8-8h48a8,8,0,0,1,8,8v8H96Zm96,168H64V64H192ZM112,104v64a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Zm48,0v64a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Z"></path></svg></button>`,c.appendChild(s),s.querySelector(".remove-meal-button").addEventListener("click",e=>{e.stopPropagation(),handleRemoveMealClick(t,a)}),s.querySelector('[data-action="view-recipe-from-plan"]').addEventListener("click",()=>{s.dataset.recipeId&&loadRecipeDetailFromRealtimeDB(s.dataset.recipeId)})})}
        async function handleRemoveMealClick(e,t){if(!confirm("Remove meal?"))return;try{await database.ref(`mealPlan/${e}/${t}`).remove(),loadMealsForSelectedDate()}catch(e){console.error("Error removing meal:",e),alert("Failed to remove.")}}
        const addMealModal=document.getElementById("add-meal-modal"),addMealModalRecipeList=document.getElementById("add-meal-modal-recipe-list"),addMealModalSearchInput=document.getElementById("add-meal-modal-search");function openAddMealModal(){addMealModal&&addMealModalSearchInput&&(populateAddMealModalRecipeList(allRecipesCache),addMealModalSearchInput.value="",addMealModal.classList.remove("hidden"))}function closeAddMealModal(){addMealModal&&addMealModal.classList.add("hidden")}
        function populateAddMealModalRecipeList(e){if(!addMealModalRecipeList)return;addMealModalRecipeList.innerHTML="",0===e.length?(addMealModalRecipeList.innerHTML='<p class="loading-placeholder">No recipes.</p>',void 0):e.forEach(t=>{const c=document.createElement("div");c.className="add-meal-recipe-item interactive-scale flex items-center p-2 bg-[#40322b] rounded-lg cursor-pointer hover:bg-[#5a3a2a]",c.dataset.recipeId=t.id,c.dataset.recipeTitle=t.title;const a=t.imageURL||"https://via.placeholder.com/50x50.png?text=No+Img";c.innerHTML=`<img src="${a}" alt="${t.title}" class="w-12 h-12 rounded-md mr-3 object-cover shrink-0"><span class="text-white flex-grow truncate" title="${t.title}">${t.title||"Untitled"}</span><button class="add-this-recipe-button interactive-scale bg-[#f0560e] text-white text-xs px-3 py-1.5 rounded-md ml-2 shrink-0 hover:bg-orange-600">Add</button>`;const n=c.querySelector(".add-this-recipe-button");n&&n.addEventListener("click",e=>{e.stopPropagation(),handleAddRecipeToPlan(t.id,t.title)}),c.addEventListener("click",()=>handleAddRecipeToPlan(t.id,t.title)),addMealModalRecipeList.appendChild(c)})}
        function handleAddMealModalSearch(){if(!addMealModalSearchInput)return;const e=addMealModalSearchInput.value.trim().toLowerCase();""===e?populateAddMealModalRecipeList(allRecipesCache):populateAddMealModalRecipeList(allRecipesCache.filter(t=>(t.title||"").toLowerCase().includes(e)||(t.description||"").toLowerCase().includes(e)))}
        async function handleAddRecipeToPlan(e,t){const c=formatDateForFirebaseKey(currentSelectedDate);try{await database.ref(`mealPlan/${c}`).push({recipeId:e,recipeTitle:t}),closeAddMealModal(),loadMealsForSelectedDate()}catch(e){console.error("Error adding to meal plan:",e),alert("Failed to add.")}}
        const shoppingListItemsContainer=document.getElementById("shopping-list-items-container"),newShoppingItemNameInput=document.getElementById("new-shopping-item-name");
        async function loadShoppingListFromDB(){if(!shoppingListItemsContainer)return;shoppingListItemsContainer.innerHTML='<p class="loading-placeholder">Loading list...</p>';try{const e=await database.ref("shoppingList").orderByChild("createdAt").once("value"),t=[];e.exists()&&e.forEach(e=>{t.push({id:e.key,...e.val()})}),displayShoppingListUI(t)}catch(e){console.error("Error loading shopping list:",e),shoppingListItemsContainer.innerHTML='<p class="loading-placeholder text-red-500">Error loading list.</p>'}}
        function displayShoppingListUI(e){if(!shoppingListItemsContainer)return;if(shoppingListItemsContainer.innerHTML="",0===e.length)return void(shoppingListItemsContainer.innerHTML='<p class="loading-placeholder">Shopping list is empty!</p>');e.sort((e,t)=>e.checked===t.checked?(e.name||"").localeCompare(t.name||""):e.checked?1:-1),e.forEach(e=>{const t=document.createElement("div");t.className=`shopping-item flex items-center gap-3 p-3 bg-[#40322b] rounded-lg list-item-enter ${e.checked?"checked":""}`,t.dataset.itemId=e.id,t.innerHTML=`\n                    <input type="checkbox" class="shopping-item-checkbox" ${e.checked?"checked":""}>\n                    <span class="item-name text-white flex-grow">${e.name||"Unnamed Item"}</span>\n                    <button class="delete-shopping-item-button interactive-scale text-gray-500 hover:text-red-500 p-1 rounded-full hover:bg-white/10">\n                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 256 256"><path d="M216,48H176V40a24,24,0,0,0-24-24H104A24,24,0,0,0,80,40v8H40a8,8,0,0,0,0,16h8V208a16,16,0,0,0,16,16H192a16,16,0,0,0,16-16V64h8a8,8,0,0,0,0-16ZM96,40a8,8,0,0,1,8-8h48a8,8,0,0,1,8,8v8H96Zm96,168H64V64H192ZM112,104v64a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Zm48,0v64a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Z"></path></svg>\n                    </button>\n                `,shoppingListItemsContainer.appendChild(t),requestAnimationFrame(()=>{t.classList.add("list-item-enter-active")}),t.querySelector(".shopping-item-checkbox").addEventListener("change",t=>{toggleShoppingItemCheckedInDB(e.id,t.target.checked)}),t.querySelector(".delete-shopping-item-button").addEventListener("click",()=>{deleteShoppingItemFromDB(e.id,t)})})}
        async function addShoppingItemToDB(){if(!newShoppingItemNameInput)return;const e=newShoppingItemNameInput.value.trim();if(!e)return void alert("Please enter an item name.");try{await database.ref("shoppingList").push({name:e,checked:!1,createdAt:serverTimestamp}),newShoppingItemNameInput.value="",newShoppingItemNameInput.focus(),loadShoppingListFromDB()}catch(e){console.error("Error adding shopping item:",e),alert("Failed to add item.")}}
        async function toggleShoppingItemCheckedInDB(e,t){try{await database.ref(`shoppingList/${e}`).update({checked:t}),loadShoppingListFromDB()}catch(e){console.error("Error updating shopping item:",e)}}
        async function deleteShoppingItemFromDB(e,t){t.classList.remove("list-item-enter-active"),t.classList.add("list-item-leave-active"),setTimeout(async()=>{try{await database.ref(`shoppingList/${e}`).remove(),loadShoppingListFromDB()}catch(e){console.error("Error deleting shopping item:",e),t.classList.remove("list-item-leave-active"),t.classList.add("list-item-enter-active")}},200)}
        async function clearCheckedShoppingItemsFromDB(){if(!confirm("Clear all checked items?"))return;try{const e=await database.ref("shoppingList").orderByChild("checked").equalTo(!0).once("value");if(e.exists()){const t={};e.forEach(e=>{t[e.key]=null}),await database.ref("shoppingList").update(t)}loadShoppingListFromDB()}catch(e){console.error("Error clearing checked items:",e),alert("Failed to clear checked items.")}}
        async function addUncheckedIngredientsToShoppingList(){const e=document.getElementById("recipe-ingredients-list");if(!e)return;const t=[];e.querySelectorAll("label").forEach(e=>{const c=e.querySelector(".form-checkbox-custom"),a=e.querySelector("p");!c.checked&&a?.textContent&&t.push(a.textContent.trim())});if(0===t.length)return void alert("No unchecked ingredients to add or no ingredients listed.");try{const c={};t.forEach(e=>{const t=database.ref("shoppingList").push().key;c[t]={name:e,checked:!1,createdAt:serverTimestamp}}),await database.ref("shoppingList").update(c),alert(`${t.length} ingredient${1===t.length?"":"s"} added to shopping list!`)}catch(e){console.error("Error adding ingredients to shopping list:",e),alert("Failed to add ingredients.")}}
        document.addEventListener("DOMContentLoaded",()=>{const e=localStorage.getItem("lastActivePageId")||"page-index";history.state&&history.state.page?showPage(history.state.page,!0):("page-index"!==e?history.replaceState({page:e},`Page ${e}`,`#${e}`):history.replaceState({page:"page-index"},"Page page-index","#page-index"),showPage(e)),loadRecipesFromRealtimeDB(),window.addEventListener("popstate",e=>{if(isInitialPageLoad)return;e.state&&e.state.page?showPage(e.state.page,!0):"page-index"!==currentPageId&&(showPage("page-index",!0),history.pushState({page:"page-index"},"Page page-index","#page-index"))}),document.getElementById("search-recipe-input")?.addEventListener("input",debounce(handleSearch,300)),document.getElementById("search-favorites-input")?.addEventListener("input",debounce(handleFavoritesSearch,300)),document.querySelectorAll(".nav-item").forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const c=e.dataset.target;"page-create-recipe"===c&&resetCreateForm(),showPage(c)})}),document.querySelectorAll('[data-action="back"]').forEach(e=>{e.addEventListener("click",()=>history.back())}),document.querySelector('[data-action="back-from-create"]')?.addEventListener("click",()=>history.back()),document.getElementById("header-profile-button-index")?.addEventListener("click",()=>showPage("page-profile")),document.getElementById("header-profile-button-favorites")?.addEventListener("click",()=>showPage("page-profile")),document.getElementById("save-recipe-button")?.addEventListener("click",saveRecipeData),document.getElementById("recipe-bookmark-button")?.addEventListener("click",e=>{e.currentTarget.dataset.recipeId&&toggleBookmarkInRealtimeDB(e.currentTarget.dataset.recipeId)}),document.getElementById("delete-recipe-button")?.addEventListener("click",e=>{e.currentTarget.dataset.recipeId&&deleteRecipeFromRealtimeDB(e.currentTarget.dataset.recipeId,e.currentTarget.dataset.imageURL)}),document.getElementById("recipe-edit-button")?.addEventListener("click",()=>{const e=document.getElementById("page-recipe").dataset.currentRecipeId;e?prepareEditForm(e):alert("Could not initiate edit.")}),document.getElementById("add-ingredients-to-shopping-list")?.addEventListener("click",addUncheckedIngredientsToShoppingList),document.getElementById("schedule-prev-week")?.addEventListener("click",navigateToPreviousWeek),document.getElementById("schedule-next-week")?.addEventListener("click",navigateToNextWeek),document.getElementById("schedule-open-add-meal-modal-button")?.addEventListener("click",openAddMealModal),document.getElementById("add-meal-modal-close-button")?.addEventListener("click",closeAddMealModal),addMealModalSearchInput&&addMealModalSearchInput.addEventListener("input",debounce(handleAddMealModalSearch,300)),document.getElementById("add-shopping-item-button")?.addEventListener("click",addShoppingItemToDB),newShoppingItemNameInput&&newShoppingItemNameInput.addEventListener("keypress",e=>{"Enter"===e.key&&(e.preventDefault(),addShoppingItemToDB())}),document.getElementById("clear-checked-shopping-items-button")?.addEventListener("click",clearCheckedShoppingItemsFromDB)});
        "serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/cookbook_bare/sw.js",{scope:"/cookbook_bare/"}).then(e=>console.log("SW registered!",e.scope)).catch(e=>console.log("SW registration failed: ",e))});
    </script>

</body>
</html>